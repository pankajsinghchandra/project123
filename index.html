<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syllabus Tracker App</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background-color: #f0f0f0; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .login-container { max-width: 400px; margin: 50px auto; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .login-container h2 { text-align: center; }
        .login-container select, .login-container input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .login-container button { width: 100%; padding: 10px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; }
        .login-container button:hover { background: #218838; }
        .error { color: red; text-align: center; }
        .school-card { background: white; padding: 15px; margin: 10px; border-radius: 8px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
        @media (max-width: 600px) {
            .login-container { width: 90%; margin: 20px auto; padding: 15px; }
            .container { padding: 10px; }
            select, input, button { font-size: 16px; }
        }
    </style>
</head>
<body>
    <div id="login" class="login-container">
        <h2>Syllabus Tracker Login</h2>
        <select id="schoolSelect">
            <option value="">Select School</option>
        </select>
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">
        <button onclick="login()">Login</button>
        <p id="error" class="error"></p>
        <button onclick="addSchool()">Add New School</button>
        <input type="file" id="importData" accept=".json">
        <button onclick="importSchools()">Import Schools</button>
    </div>
    <div id="app" class="container" style="display: none;">
        <h1>Syllabus Tracker</h1>
        <button onclick="switchSchool()">Switch School</button>
        <button onclick="exportData()">Export Data</button>
        <button onclick="logout()">Logout</button>
        <div id="schoolData"></div>
    </div>
    <script>
        try {
            const defaultSchool = { name: 'Default School', syllabus: 'Sample syllabus data' };
            let schools = JSON.parse(localStorage.getItem('schools')) || [defaultSchool];

            function loadSchools() {
                try {
                    const select = document.getElementById('schoolSelect');
                    if (!select) {
                        alert('Error: School dropdown not found');
                        return;
                    }
                    select.innerHTML = '<option value="">Select School</option>';
                    schools.forEach(school => {
                        const option = document.createElement('option');
                        option.value = school.name;
                        option.text = school.name;
                        select.appendChild(option);
                    });
                } catch (e) {
                    alert('Error loading schools: ' + e.message);
                }
            }

            function login() {
                try {
                    const school = document.getElementById('schoolSelect').value;
                    const username = document.getElementById('username').value;
                    const password = document.getElementById('password').value;
                    if (!school) {
                        document.getElementById('error').innerText = 'Please select a school';
                        return;
                    }
                    if (username === 'admin' && password === 'admin123') {
                        document.getElementById('login').style.display = 'none';
                        document.getElementById('app').style.display = 'block';
                        loadSchoolData(school);
                    } else {
                        document.getElementById('error').innerText = 'Invalid username or password';
                    }
                } catch (e) {
                    alert('Login error: ' + e.message);
                }
            }

            function logout() {
                document.getElementById('login').style.display = 'block';
                document.getElementById('app').style.display = 'none';
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                document.getElementById('error').innerText = '';
            }

            function switchSchool() {
                document.getElementById('login').style.display = 'block';
                document.getElementById('app').style.display = 'none';
                loadSchools();
            }

            function addSchool() {
                const name = prompt('Enter school name:');
                if (name) {
                    schools.push({ name, syllabus: '' });
                    localStorage.setItem('schools', JSON.stringify(schools));
                    loadSchools();
                }
            }

            function exportData() {
                const dataStr = JSON.stringify(schools);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'schools.json';
                a.click();
                URL.revokeObjectURL(url);
            }

            function importSchools() {
                const fileInput = document.getElementById('importData');
                if (fileInput.files[0]) {
                    const reader = new FileReader();
                    reader.onload = () => {
                        try {
                            const importedSchools = JSON.parse(reader.result);
                            schools = [defaultSchool, ...importedSchools];
                            localStorage.setItem('schools', JSON.stringify(schools));
                            loadSchools();
                        } catch (e) {
                            alert('Invalid JSON file: ' + e.message);
                        }
                    };
                    reader.readAsText(fileInput.files[0]);
                }
            }

            function loadSchoolData(schoolName) {
                try {
                    const school = schools.find(s => s.name === schoolName);
                    const dataDiv = document.getElementById('schoolData');
                    dataDiv.innerHTML = `<div class="school-card"><h2>${school.name}</h2><p>${school.syllabus || 'No syllabus data'}</p></div>`;
                } catch (e) {
                    alert('Error loading school data: ' + e.message);
                }
            }

            document.addEventListener('DOMContentLoaded', () => {
                try {
                    loadSchools();
                } catch (e) {
                    alert('Initialization error: ' + e.message);
                }
            });
        } catch (e) {
            alert('Script error: ' + e.message);
        }
    </script>
</body>
</html>